<!DOCTYPE HTML><html lang="zh-hans"><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>第四章：优化图片 · 前端性能与工程化</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content=""><meta name="generator" content="GitBook 3.2.3"><meta name="author" content="王顶"><link rel="stylesheet" href="../gitbook/style.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-forkmegithub-cn/plugin.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-image-captions-extended/image-captions.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-bsz/bsz.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-gtalk/gtalk.css"><link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css"><link rel="stylesheet" href="../styles/website.css"><meta name="HandheldFriendly" content="true"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png"><link rel="shortcut icon" href="http://i.wangding.co/favicon.svg"><script>var _hmt = _hmt || [];(function(){var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?9ce1f00696329e6883af84b5fb54ca21";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();</script><link rel="next" href="ch05-opt-font.html"><link rel="prev" href="ch03-opt-css.html"></head><body><div class="book"><div class="book-summary"><div id="book-search-input" role="search"><input type="text" placeholder="输入并搜索"></div><nav role="navigation"><ul class="summary"><li class="chapter" data-level="1.1" data-path="../"><a href="../">简介</a></li><li class="chapter" data-level="1.2" data-path="ch01-introduction.html"><a href="ch01-introduction.html">课程说明</a></li><li class="header">前端性能优化</li><li class="chapter" data-level="2.1" data-path="ch01-wpo-introduction.html"><a href="ch01-wpo-introduction.html">第一章：性能优化概述</a></li><li class="chapter" data-level="2.2" data-path="ch02-wpo-tools.html"><a href="ch02-wpo-tools.html">第二章：性能评估工具</a></li><li class="chapter" data-level="2.3" data-path="ch03-opt-css.html"><a href="ch03-opt-css.html">第三章：优化 CSS</a></li><li class="chapter active" data-level="2.4" data-path="ch04-opt-image.html"><a href="ch04-opt-image.html">第四章：优化图片</a></li><li class="chapter" data-level="2.5" data-path="ch05-opt-font.html"><a href="ch05-opt-font.html">第五章：优化字体</a></li><li class="chapter" data-level="2.6" data-path="ch06-opt-javascript.html"><a href="ch06-opt-javascript.html">第六章：优化 JavaScript</a></li><li class="chapter" data-level="2.7" data-path="ch07-opt-others.html"><a href="ch07-opt-others.html">第七章：其他</a></li><li class="header">前端工程化</li><li class="chapter" data-level="3.1" data-path="ch02-build-automation.html"><a href="ch02-build-automation.html">第一章：自动化构建</a></li><li class="chapter" data-level="3.2" data-path="ch03-ui-introduction.html"><a href="ch03-ui-introduction.html">第二章：UI 概述</a></li><li class="chapter" data-level="3.3" data-path="ch04-h5-buildin-widget.html"><a href="ch04-h5-buildin-widget.html">第三章：H5 内置控件</a></li><li class="chapter" data-level="3.4" data-path="ch05-validation.html"><a href="ch05-validation.html">第四章：数据合法性校验</a></li><li class="chapter" data-level="3.5" data-path="ch06-third-part-component.html"><a href="ch06-third-part-component.html">第五章：第三方组件</a></li><li class="chapter" data-level="3.6" data-path="ch07-diy-ui-component.html"><a href="ch07-diy-ui-component.html">第六章：自定义 UI 组件</a></li><li class="chapter" data-level="3.7" data-path="ch08-spa-mvc.html"><a href="ch08-spa-mvc.html">第七章：SPA 和 MVC</a></li><li class="chapter" data-level="3.8" data-path="ch09-data-storage.html"><a href="ch09-data-storage.html">第八章：数据存储</a></li><li class="header">附录</li><li class="chapter" data-level="4.1" data-path="setup-dev-env.html"><a href="setup-dev-env.html">搭建 Node.js 开发环境</a></li><li class="chapter" data-level="4.2" data-path="mocha-dev-env.html"><a href="mocha-dev-env.html">升级开发环境</a></li><li class="chapter" data-level="4.3" data-path="gogs-drone-ci.html"><a href="gogs-drone-ci.html">搭建 gogs + drone 持续集成环境</a></li><li class="chapter" data-level="4.4" data-path="video.html"><a href="video.html">课程视频清单</a></li><li class="divider"></li><li><a href="https://www.gitbook.com" target="blank" class="gitbook-link">本书使用 GitBook 发布</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header" role="navigation"><!-- Title --><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="..">第四章：优化图片</a></h1></div><div class="page-wrapper" tabindex="-1" role="main"><div class="page-inner"><div class="search-plus" id="book-search-results"><div class="search-noresults"><section class="normal markdown-section"><div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon"></span><a href="#第-4-章：优化图片"><b> </b>第 4 章：优化图片</a></li><ul><li><span class="title-icon"></span><a href="#阅读参考资料"><b>1. </b>阅读参考资料</a></li><li><span class="title-icon"></span><a href="#选择合适的图片格式"><b>2. </b>选择合适的图片格式</a></li><li><span class="title-icon"></span><a href="#使用正确的图片尺寸"><b>3. </b>使用正确的图片尺寸</a></li><li><span class="title-icon"></span><a href="#响应式图片"><b>4. </b>响应式图片</a></li><li><span class="title-icon"></span><a href="#把-gif-动画转换为视频"><b>5. </b>把 GIF 动画转换为视频</a></li><li><span class="title-icon"></span><a href="#延迟加载图片"><b>6. </b>延迟加载图片</a></li><li><span class="title-icon"></span><a href="#用-lazysizes-延迟加载图片"><b>7. </b>用 lazysizes 延迟加载图片</a></li><li><span class="title-icon"></span><a href="#骨架屏"><b>8. </b>骨架屏</a></li><li><span class="title-icon"></span><a href="#渐进式-jpeg"><b>9. </b>渐进式 JPEG</a></li><li><span class="title-icon"></span><a href="#雪碧图"><b>10. </b>雪碧图</a></li><li><span class="title-icon"></span><a href="#综合案例"><b>11. </b>综合案例</a></li></ul></ul></div><a href="#第-4-章：优化图片" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="第-4-章：优化图片"><a name="第-4-章：优化图片" class="anchor-navigation-ex-anchor" href="#第-4-章：优化图片"><i class="fa fa-link" aria-hidden="true"></i></a> 第 4 章：优化图片</h1><h2 id="阅读参考资料"><a name="阅读参考资料" class="anchor-navigation-ex-anchor" href="#阅读参考资料"><i class="fa fa-link" aria-hidden="true"></i></a>1. 阅读参考资料</h2><ul><li><a href="https://wpocs.cn/docs/fast-load-time/choose-the-right-image-format.html" target="_blank">选择正确的图片格式</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/compress-images.html" target="_blank">选择正确的压缩级别</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/use-imagemin-to-compress-images.html" target="_blank">使用 Imagemin 压缩图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/replace-gifs-with-videos.html" target="_blank">用视频替换 GIF 动画以加快页面加载</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/serve-responsive-images.html" target="_blank">提供响应式图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/serve-images-with-correct-dimensions.html" target="_blank">提供尺寸正确的图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/serve-images-webp.html" target="_blank">使用 WebP 图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/image-cdns.html" target="_blank">使用图像 CDN 优化图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/lazy-loading.html" target="_blank">使用延迟加载提高加载速度</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/lazy-loading-images.html" target="_blank">延迟加载图像</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/lazy-loading-video.html" target="_blank">延迟加载视频</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/browser-level-imag
e-lazy-loading.html" target="_blank">浏览器内置图像延迟加载</a></li><li><a href="https://wpocs.cn/docs/fast-load-time/use-lazysizes
-to-lazyload-images.html" target="_blank">使用 lazysizes 延迟加载图像</a></li></ul><h2 id="选择合适的图片格式"><a name="选择合适的图片格式" class="anchor-navigation-ex-anchor" href="#选择合适的图片格式"><i class="fa fa-link" aria-hidden="true"></i></a>2. 选择合适的图片格式</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd06</code>，<code>npx http-server wd06</code></li><li>用 Lighthouse 对网站 <code>wd06</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Serve images in next-gen formats</code></li><li>复制 <code>wd06</code> 文件夹，<code>cp -r wd06 image-format &amp;&amp; cd image-format</code></li><li>根据优化建议详情，修改两个图片的格式，把 <code>flower_photo.jpg</code> 改成 webp 格式，把 <code>flower_logo.png</code> 改成 svg 格式</li><li>全局安装 <code>cwebp</code>，<code>npm i -g cwebp</code></li><li>用 <code>cwebp</code> 做图片格式转换，<code>cwebp flower_photo.jpg -o flower_photo.webp</code></li><li>检查 webp 和 jpg 格式的图片文件大小的差异，<code>ls -lh</code></li><li>用 <a href="https://www.img2go.com/convert-to-svg" target="_blank">IMG2GO</a> 将 <code>flower_photo.png</code> 转换成 svg 格式</li><li>检查 svg 和 jpg 格式的图片文件大小的差异，<code>ls -lh</code></li><li>用 <code>svgo</code> 压缩 SVG 图片，<code>npx svgo flower_logo.svg -o flower_logo.min.svg</code></li><li>观察压缩前后 SVG 图片尺寸的变化，<code>ls -al *.svg</code></li><li>思考 SVG 尺寸变化背后的原因</li><li>修改 <code>index.html</code> 文件，使用两个新格式的图片</li><li>启动网站 <code>image-format</code>，<code>npx http-server image-format</code></li><li>用 Lighthouse 对 <code>image-format</code> 网站做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Serve images in next-gen formats</code></li></ul><h2 id="使用正确的图片尺寸"><a name="使用正确的图片尺寸" class="anchor-navigation-ex-anchor" href="#使用正确的图片尺寸"><i class="fa fa-link" aria-hidden="true"></i></a>3. 使用正确的图片尺寸</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd06</code>，<code>npx http-server wd06</code></li><li>用 Lighthouse 对网站 <code>wd06</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Properly size images</code></li><li>复制 <code>wd06</code> 文件夹，<code>cp -r wd06 image-dimensions &amp;&amp; cd image-dimensions</code></li><li>检查 Elements 面板，查看 <code>flower_logo.png</code> 的 CSS 宽高属性</li><li>检查 <code>flower_logo.png</code> 图片的宽高属性，<code>flower_logo.png</code> 图片是否发生了缩放</li><li>安装 ImageMagic 工具，<code>sudo yum install -y ImageMagick</code></li><li>调整图片 <code>flower_logo.png</code> 的尺寸，<code>convert flower_logo.png -resize 50x50 flower_logo_50x50.png</code></li><li>修改 <code>index.html</code> 代码，使用修改后的图片</li><li>启动网站 <code>image-dimensions</code>，<code>npx http-server image-dimensions</code></li><li>用 Lighthouse 对 <code>image-dimensions</code> 网站做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Properly size images</code></li><li>思考为什么不调整 <code>flower_photo.jpg</code> 的尺寸</li></ul><h2 id="响应式图片"><a name="响应式图片" class="anchor-navigation-ex-anchor" href="#响应式图片"><i class="fa fa-link" aria-hidden="true"></i></a>4. 响应式图片</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd07</code>，<code>npx http-server wd07</code></li><li>用 Lighthouse 对网站 <code>wd07</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Properly size images</code></li><li>复制网站 <code>wd07</code>，<code>cp -r wd07 response &amp;&amp; cd response</code></li><li>针对 <code>flower_photo</code> 图片实现多种屏幕尺寸的支持（宽度：720px，1080px）</li><li>用 ImageMagic 工具，生成多种图片尺寸</li><li>使用三种不同的方案实现响应式图片，CSS 媒体查询，<code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">srcset</span><span class="token punctuation">&gt;</span></span></code> 和 <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span></code></li><li>启动网站 <code>response</code>, <code>npx http-server response</code></li><li>用 Lighthouse 对网站 <code>wd07</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Properly size images</code></li><li>调整设备尺寸，刷新页面，通过 Network 面板，查看不同图片资源的加载</li></ul><h2 id="把-gif-动画转换为视频"><a name="把-gif-动画转换为视频" class="anchor-navigation-ex-anchor" href="#把-gif-动画转换为视频"><i class="fa fa-link" aria-hidden="true"></i></a>5. 把 GIF 动画转换为视频</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd08</code>，<code>npx http-server wd08</code></li><li>用 Lighthouse 对网站 <code>wd08</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Use video formats for animated content</code></li><li>复制 <code>wd08</code> 文件夹，<code>cp -r wd08 gif2mp4 &amp;&amp; cd gif2mp4</code></li><li>安装 <code>ffmpeg</code> 工具：<pre class="language-"><code class="lang-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> -y epel-release
<span class="token function">sudo</span> <span class="token function">rpm</span> -v --import http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro
<span class="token function">sudo</span> <span class="token function">rpm</span> -Uvh http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-5.el7.nux.noarch.rpm
<span class="token function">sudo</span> yum <span class="token function">install</span> -y ffmpeg
</code></pre></li><li>检查 <code>ffmpeg</code> 工具是否正常工作，<code>ffmpeg -version</code></li><li>转换 GIF 动画为 MP4，<code>ffmpeg -i cat-herd.gif -vf &quot;crop=trunc(iw/2)*2:trunc(ih/2)*2&quot; -b:v 0 -crf 25 -f mp4 -vcodec libx264 -pix_fmt yuv420p cat-herd.mp4</code></li><li>检查文件大小，<code>ls -lh</code></li><li>修改 <code>index.html</code> 文件，使用 <code>video</code> 标签播放视频，删除 <code>img</code> 标签<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">autoplay</span> <span class="token attr-name">loop</span> <span class="token attr-name">muted</span> <span class="token attr-name">playsinline</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>images/cat-herd.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video/mp4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre></li><li><strong>注意</strong>：<code>video</code> 标签需要支持自动播放，循环播放和静音功能</li><li>启动网站 <code>gif2mp4</code>，<code>npx http-server gif2mp4</code></li><li>用 Lighthouse 对网站 <code>gif2mp4</code> 做桌面性能评测</li><li>查看 Lighthouse 的优化建议，是否有 <code>Use video formats for animated content</code></li></ul><h2 id="延迟加载图片"><a name="延迟加载图片" class="anchor-navigation-ex-anchor" href="#延迟加载图片"><i class="fa fa-link" aria-hidden="true"></i></a>6. 延迟加载图片</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd09</code>，<code>npx http-server wd09</code></li><li>用 Network 面板对网站 <code>wd09</code> 做性能评测</li><li>通过瀑布图，观察页面上图片加载的过程</li><li>记录页面加载完成的两个时间：DCL 和 Load</li><li>复制 <code>wd09</code> 文件夹，<code>cp -r wd09 image-loading-lazy &amp;&amp; cd image-loading-lazy</code></li><li>修改 <code>index.html</code> 文件，在所有 <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><span class="token punctuation">&gt;</span></span></code> 标签中（除了前两个）添加属性 <code>loading=&apos;lazy&apos;</code></li><li>启动网站 <code>image-loading-lazy</code>，<code>npx http-server image-loading-lazy</code></li><li>用 Network 面板对网站 <code>image-loading-lazy</code> 做性能评测</li><li>通过瀑布图，观察页面上图片加载的过程</li><li>记录页面加载完成的两个时间：DCL 和 Load，跟优化前比较页面加载速度</li><li>向下翻页观察 Network 面板图片延迟加载的效果</li></ul><h2 id="用-lazysizes-延迟加载图片"><a name="用-lazysizes-延迟加载图片" class="anchor-navigation-ex-anchor" href="#用-lazysizes-延迟加载图片"><i class="fa fa-link" aria-hidden="true"></i></a>7. 用 lazysizes 延迟加载图片</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd10</code>，<code>npx http-server wd10</code></li><li>用 Network 面板对网站 <code>wd10</code> 做性能评测，设置网络节流慢速 3G</li><li>观察瀑布图，分析页面的五个图片是否延迟加载，记录 DCL 和 Load 两个时间</li><li>复制 <code>wd10</code> 文件夹，<code>cp -r wd10 lazysizes &amp;&amp; cd lazysizes</code></li><li>修改 <code>index.html</code> 文件，使用 <code>lazysizes</code> 实现非首屏图片的延迟加载</li><li>启动网站 <code>lazysizes</code>，<code>npx http-server lazysizes</code></li><li>用 Network 面板对网站 <code>lazysizes</code> 做性能评测</li><li>观察瀑布图，分析页面的五个图片是否延迟加载，记录 DCL 和 Load 两个时间</li><li>分析优化后跟优化前 DCL 和 Load 有什么区别，为什么</li></ul><h2 id="骨架屏"><a name="骨架屏" class="anchor-navigation-ex-anchor" href="#骨架屏"><i class="fa fa-link" aria-hidden="true"></i></a>8. 骨架屏</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd09</code>，<code>npx http-server wd09</code></li><li>用 Network 面板对网站 <code>wd09</code> 做性能评测</li><li>通过瀑布图，观察页面上图片加载的过程</li><li>记录页面加载完成的两个时间：DCL 和 Load</li><li>复制 <code>wd09</code> 文件夹，<code>cp -r wd09 skeleton &amp;&amp; cd skeleton</code></li><li>修改 <code>index.html</code> 文件，给 <code>img</code> 添加 CSS 样式 <code>background-color: lightgray;</code></li><li>启动网站 <code>skeleton</code>，<code>npx http-server skeleton</code></li><li>用 Network 面板对网站 <code>skeleton</code> 做性能评测</li><li>通过瀑布图，观察页面上图片加载的过程</li><li>向下翻页骨架屏的效果</li></ul><h2 id="渐进式-jpeg"><a name="渐进式-jpeg" class="anchor-navigation-ex-anchor" href="#渐进式-jpeg"><i class="fa fa-link" aria-hidden="true"></i></a>9. 渐进式 JPEG</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd11</code>，<code>npx http-server wd11</code></li><li>在 Network 面板设置网络限流：慢速 3G</li><li>刷新页面，观察图片加载的过程</li><li>复制 <code>wd11</code> 文件夹，<code>cp -r wd11 progressive-jpg &amp;&amp; cd progressive-jpg</code></li><li>用 ImageMagic 工具生成渐进式 JPEG，<code>convert 6.jpg -interlace Plane 7.jpg</code></li><li>修改 <code>index.html</code> 使用 <code>7.jpg</code></li><li>启动网站 <code>progressive-jpg</code>，<code>npx http-server progressive-jpg</code></li><li>刷新页面，观察图片加载的过程</li></ul><h2 id="雪碧图"><a name="雪碧图" class="anchor-navigation-ex-anchor" href="#雪碧图"><i class="fa fa-link" aria-hidden="true"></i></a>10. 雪碧图</h2><p>操作步骤如下：</p><ul><li>启动网站 <code>wd12</code>，<code>npx http-server wd12</code></li><li>在 Network 面板设置网络限流：慢速 3G</li><li>刷新页面，观察图片加载的过程，结合页面内容，是否观察到 6 个图标文件</li><li>复制 <code>wd12</code> 文件夹，<code>cp -r wd12 sprite &amp;&amp; cd sprite</code></li><li>用 svg-sprite 工具生成 SVG 雪碧图，<code>npx svg-sprite --css --css-render-less --css-dest=less --css-sprite=../img/icons.svg --css-layout=diagonal img/icon-images/*.svg</code></li><li>查看新生成的 LESS 文件：<code>sprite.less</code> 和生成的雪碧图：<code>icons.svg</code>，<code>ls less img</code></li><li>查看 <code>sprite.less</code> 文件内容，<code>cat less/sprite.less</code></li><li>修改 <code>main.less</code> 和 <code>global_small.less</code> 使用雪碧图</li><li>运行构建脚本将 LESS 代码转成 CSS 代码，<code>./less.sh</code></li><li>启动网站 <code>sprite</code>，<code>npx http-server sprite</code></li><li>刷新页面，观察图片加载的过程</li></ul><h2 id="综合案例"><a name="综合案例" class="anchor-navigation-ex-anchor" href="#综合案例"><i class="fa fa-link" aria-hidden="true"></i></a>11. 综合案例</h2><p>操作步骤如下：</p><ul><li>一位毕业生咨询的项目情况如下：</li></ul><figure id="fig2.4.1"><a href="images/suhan-talk.jpg" rel="grouped" title="部分聊天记录" target="_self" class="fancybox"><div class="image-wrapper"><img src="images/suhan-talk.jpg" alt="部分聊天记录"></div></a><figcaption>图：部分聊天记录</figcaption></figure><ul><li>当时用网络面板对网站的性能评测如下图所示：</li></ul><figure id="fig2.4.2"><a href="images/suhan-img.png" rel="grouped" title="项目中有大量的图标资源，点击查看大图" target="_self" class="fancybox"><div class="image-wrapper"><img src="images/suhan-img.png" alt="项目中有大量的图标资源，点击查看大图"></div></a><figcaption>图：项目中有大量的图标资源，点击查看大图</figcaption></figure><figure id="fig2.4.3"><a href="images/suhan-network.png" rel="grouped" title="项目的时间线不理想，点击查看大图" target="_self" class="fancybox"><div class="image-wrapper"><img src="images/suhan-network.png" alt="项目的时间线不理想，点击查看大图"></div></a><figcaption>图：项目的时间线不理想，点击查看大图</figcaption></figure><ul><li>网站地址：<a href="https://www.yunyingfile.com/" target="_blank">https://www.yunyingfile.com/</a></li><li>目前该网站已经做了一些调整和优化</li><li>请思考并回答以下问题：<ul><li>现在的网站性能还存在哪些问题？应该如何改进？</li><li>之前的网站性能有哪些问题？应该如何改进？</li></ul></li></ul><p></p><footer class="page-footer"><span class="page-footer-copyright">2018 - <span class="bsz-this-year"></span> by <a href="http://i.wangding.co" target="_blank">王顶</a>. All rights reserved.</span><span class="page-footer-footer-update"><span id="busuanzi_container_site_uv">本站访客人数 <span id="busuanzi_value_site_uv"></span> 人次</span></span></footer><script>document.getElementsByClassName("bsz-this-year")[0].innerHTML = new Date().getFullYear();</script><script async src="//cdn.jsdelivr.net/gh/sukkaw/busuanzi@2.3/bsz.pure.mini.js"></script><p></p><p></p><div id="gitalk-container"></div><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script>window.onload = function() {gitbook.events.on("page.change", function() {var gitalk = new Gitalk({"clientID":"086e21b153d1d4f035be","clientSecret":"62086ccd1d88050f3f9d4fe2124844dcfaac8ba6","repo":"spa","owner":"wangding","admin":["wangding"],"labels":["SPA"],"id":"/chapters/ch04-opt-image.html"});gitalk.render("gitalk-container");});};var gitalk = new Gitalk({"clientID":"086e21b153d1d4f035be","clientSecret":"62086ccd1d88050f3f9d4fe2124844dcfaac8ba6","repo":"spa","owner":"wangding","admin":["wangding"],"labels":["SPA"],"id":"/chapters/ch04-opt-image.html"});gitalk.render("gitalk-container");</script><p></p></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1></div></div></div></div></div></div><a href="ch03-opt-css.html" class="navigation navigation-prev" aria-label="Previous page: 第三章：优化 CSS"><i class="fa fa-angle-left"></i> </a><a href="ch05-opt-font.html" class="navigation navigation-next" aria-label="Next page: 第五章：优化字体"><i class="fa fa-angle-right"></i></a></div><script>var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"第四章：优化图片","level":"2.4","depth":1,"next":{"title":"第五章：优化字体","level":"2.5","depth":1,"path":"chapters/ch05-opt-font.md","ref":"chapters/ch05-opt-font.md","articles":[]},"previous":{"title":"第三章：优化 CSS","level":"2.3","depth":1,"path":"chapters/ch03-opt-css.md","ref":"chapters/ch03-opt-css.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","-highlight","-sharing","edit-link","forkmegithub-cn","search-plus","sharing-plus","anchor-navigation-ex","copy-code-button","prism","splitter","image-captions-extended","bsz","fancybox","image-wrapper","gtalk"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"image-wrapper":{},"prism":{},"fancybox":{"helpers":{"buttons":{}}},"splitter":{},"image-captions-extended":{},"bsz":{"copyright":"2018&nbsp;-&nbsp;<span class=\"bsz-this-year\"></span>&nbsp;by&nbsp;<a href=\"http://i.wangding.co\">王顶</a>.&nbsp;All rights reserved."},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"fontsettings":{"theme":"white","family":"sans","size":2},"gtalk":{"clientID":"086e21b153d1d4f035be","clientSecret":"62086ccd1d88050f3f9d4fe2124844dcfaac8ba6","repo":"spa","owner":"wangding","admin":["wangding"],"labels":["SPA"]},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":false,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"copy-code-button":{},"forkmegithub-cn":{"color":"red","url":"https://github.com/wangding/spa"},"sharing":{"qq":true,"all":["weibo","douban","qzone","qq"],"douban":true,"facebook":false,"weibo":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":false,"messenger":false,"line":false,"vk":false,"pocket":false,"google":false,"viber":false,"stumbleupon":false,"qzone":true,"linkedin":false},"edit-link":{"label":"编辑本页","base":"https://github.com/wangding/spa/blob/master/"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{},"image-captions":{"caption":"图：_CAPTION_","variable_name":"_pictures"}},"theme":"default","author":"王顶","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"_pictures":[{"backlink":"index.html#fig1.1.1","level":"1.1","list_caption":"Figure: QQ 群二维码，王顶，408542507@qq.com","alt":"QQ 群二维码，王顶，408542507@qq.com","nro":1,"url":"http://sample.wangding.co/images/student-group.webp","index":1,"caption_template":"图：_CAPTION_","label":"QQ 群二维码，王顶，408542507@qq.com","attributes":{},"skip":false,"key":"1.1.1"},{"backlink":"chapters/ch04-opt-image.html#fig2.4.1","level":"2.4","list_caption":"Figure: 部分聊天记录","alt":"部分聊天记录","nro":2,"url":"./images/suhan-talk.jpg","index":1,"caption_template":"图：_CAPTION_","label":"部分聊天记录","attributes":{},"skip":false,"key":"2.4.1"},{"backlink":"chapters/ch04-opt-image.html#fig2.4.2","level":"2.4","list_caption":"Figure: 项目中有大量的图标资源，点击查看大图","alt":"项目中有大量的图标资源，点击查看大图","nro":3,"url":"./images/suhan-img.png","index":2,"caption_template":"图：_CAPTION_","label":"项目中有大量的图标资源，点击查看大图","attributes":{},"skip":false,"key":"2.4.2"},{"backlink":"chapters/ch04-opt-image.html#fig2.4.3","level":"2.4","list_caption":"Figure: 项目的时间线不理想，点击查看大图","alt":"项目的时间线不理想，点击查看大图","nro":4,"url":"./images/suhan-network.png","index":3,"caption_template":"图：_CAPTION_","label":"项目的时间线不理想，点击查看大图","attributes":{},"skip":false,"key":"2.4.3"},{"backlink":"chapters/ch07-diy-ui-component.html#fig3.6.1","level":"3.6","list_caption":"Figure: 转到对话框尺寸标注","alt":"转到对话框尺寸标注","nro":5,"url":"images/dlg-goto-size.webp","index":1,"caption_template":"图：_CAPTION_","label":"转到对话框尺寸标注","attributes":{},"skip":false,"key":"3.6.1"},{"backlink":"chapters/ch07-diy-ui-component.html#fig3.6.2","level":"3.6","list_caption":"Figure: 转到对话框组件测试","alt":"转到对话框组件测试","nro":6,"url":"images/dlg-goto.webp","index":2,"caption_template":"图：_CAPTION_","label":"转到对话框组件测试","attributes":{},"skip":false,"key":"3.6.2"},{"backlink":"chapters/ch07-diy-ui-component.html#fig3.6.3","level":"3.6","list_caption":"Figure: 关于对话框组件测试","alt":"关于对话框组件测试","nro":7,"url":"images/dlg-about.webp","index":3,"caption_template":"图：_CAPTION_","label":"关于对话框组件测试","attributes":{},"skip":false,"key":"3.6.3"},{"backlink":"chapters/ch07-diy-ui-component.html#fig3.6.4","level":"3.6","list_caption":"Figure: 列表框组件测试","alt":"列表框组件测试","nro":8,"url":"images/com-list.gif","index":4,"caption_template":"图：_CAPTION_","label":"列表框组件测试","attributes":{},"skip":false,"key":"3.6.4"},{"backlink":"chapters/setup-dev-env.html#fig4.1.1","level":"4.1","list_caption":"Figure: vim 插件的安装过程：王顶，408542507@qq.com","alt":"vim 插件的安装过程：王顶，408542507@qq.com","nro":9,"url":"images/vim-plugin-install.webp","index":1,"caption_template":"图：_CAPTION_","label":"vim 插件的安装过程：王顶，408542507@qq.com","attributes":{},"skip":false,"key":"4.1.1"},{"backlink":"chapters/mocha-dev-env.html#fig4.2.1","level":"4.2","list_caption":"Figure: vim-plugin-install","alt":"vim-plugin-install","nro":10,"url":"images/vim-plugin-install.webp","index":1,"caption_template":"图：_CAPTION_","label":"vim-plugin-install","attributes":{},"skip":false,"key":"4.2.1"}]},"title":"前端性能与工程化","language":"zh-hans","gitbook":"*","description":"前端性能与工程化"},"file":{"path":"chapters/ch04-opt-image.md","mtime":"2022-07-15T07:04:34.301Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-07-15T07:06:05.613Z"},"basePath":"..","book":{"language":""}});
        });</script></div><script src="../gitbook/gitbook.js"></script><script src="../gitbook/theme.js"></script><script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script><script src="../gitbook/gitbook-plugin-forkmegithub-cn/plugin.js"></script><script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script><script src="../gitbook/gitbook-plugin-search-plus/search.js"></script><script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script><script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script><script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script><script src="../gitbook/gitbook-plugin-fancybox/jquery.min.js"></script><script src="../gitbook/gitbook-plugin-fancybox/jquery.mousewheel.pack.js"></script><script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox.pack.js"></script><script src="../gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.js"></script><script src="../gitbook/gitbook-plugin-fancybox/plugin.js"></script><script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>